# JNotes Clone - Бесплатный аналог Jnotes

## Обзор проекта

JNotes Clone - это бесплатный аналог Jnotes с полным паритетом функций, построенный на принципах офлайн-first, приватности и локального шифрования. Проект реализует современную архитектуру монорепо с поддержкой веб-платформы и Android.

## Архитектура

### Монорепо структура
```
jnotes-clone/
├── apps/
│   ├── web/                 # Next.js 14 веб-приложение
│   └── mobile/              # Android Jetpack Compose
├── services/
│   ├── api/                 # NestJS API сервис
│   ├── worker/              # BullMQ воркеры (OCR, AI)
│   └── vector/              # Qdrant векторная БД
├── packages/
│   ├── ink-engine/          # WASM ядро для штрихов
│   ├── pdf/                 # PDF.js рендер + аннотации
│   ├── ocr/                 # Tesseract + MLKit обертки
│   ├── search/              # Hybrid BM25 + vector поиск
│   ├── sync/                # CRDT Yjs + P2P WebRTC
│   └── ai/                  # OpenAI/Claude/Local LLM
└── infra/                   # Docker Compose, Traefik
```

### Технологический стек

**Frontend (Web):**
- Next.js 14 с App Router
- React 18 + TypeScript
- Canvas/WebGL для рендера штрихов
- Material 3 дизайн-система
- PWA для офлайн работы

**Frontend (Mobile):**
- Android Jetpack Compose
- Kotlin + Material 3
- Stylus Input API
- MLKit OCR
- Room для локального хранения

**Backend:**
- NestJS + TypeScript
- PostgreSQL + Prisma ORM
- BullMQ для фоновых задач
- Qdrant для векторного поиска
- Redis для кэширования

**Инфраструктура:**
- Docker Compose
- Traefik для роутинга
- TLS сертификаты
- S3-совместимое хранилище

## Дизайн-система (Material 3)

### Цветовая палитра
- **Акцентные цвета**: 3 основных цвета для инструментов
- **Нейтральная палитра**: для спокойной "бумажной" сцены
- **Темы**: светлая "ivory", тёмная "graphite", eye-care

### Типографика
- **Scale**: Material 3 типографическая шкала
- **Плотности**: адаптивные размеры для разных экранов
- **Отступы**: 8dp система отступов
- **Поверхности**: мягкие тени и слои

### Компоненты
- **Кнопки**: Primary CTA выделены цветом/размером
- **Вторичные действия**: тональные кнопки/текст-кнопки
- **Панели инструментов**: контекстные с быстрыми пресетами
- **Навигация**: нижняя навигация + вкладки

## Ключевые функции

### Рукописный ввод
- **Цифровые чернила**: давление, наклон, сглаживание
- **Вариативная ширина кисти**: динамическое изменение
- **Слои**: поддержка множественных слоев
- **Ластик**: штриховой и пиксельный
- **Авто-формы**: распознавание и преобразование

### PDF аннотации
- **Импорт/рендер**: большие PDF файлы
- **Инструменты**: маркер, линии, стикеры, ссылки
- **Экспорт**: XFDF формат с вжигаемыми слоями
- **Производительность**: частичный ререндер страниц

### Текст и мультимедиа
- **Комбинированные страницы**: рукопись + текст + изображения
- **Аудиозапись**: с временными маркерами
- **Синхронизация**: аудио и штрихи на временной шкале

### Организация
- **Структура**: папки/подпапки, закладки, теги
- **Поиск**: быстрый поиск по названию/контенту
- **Синхронизация**: локальные копии + облачный бэкап

### AI функции
- **AI Summary**: сегментация и сжатие в тезисы
- **AI Flashcards**: извлечение Q&A пар
- **Генерация тестов**: MCQ, True-False, Short Answer
- **Локальный режим**: поддержка локальных LLM

## Безопасность и приватность

### Шифрование
- **Локальное шифрование**: libsodium/XChaCha20-Poly1305
- **E2EE синхронизация**: сквозное шифрование
- **Приватность по умолчанию**: офлайн обработка

### Конфиденциальность
- **Явное согласие**: на облачные вызовы
- **Шифрование временных файлов**: защита очередей
- **Отключаемая телеметрия**: полный контроль

## План разработки (MVP)

### Неделя 1-2: Основа
- [x] Структура монорепо
- [ ] ink-engine (WASM)
- [ ] Canvas/Compose кисти
- [ ] Базовый PDF рендер
- [ ] Room/IndexedDB

### Неделя 3-4: Функции
- [ ] OCR pipeline
- [ ] Поиск
- [ ] Папки/теги
- [ ] Шаблоны (Cornell/линейка)
- [ ] Аудиозапись + маркеры

### Неделя 5-6: AI и синхронизация
- [ ] AI Summary/Flashcards (локальные)
- [ ] CRDT синхронизация
- [ ] Экспорт Anki
- [ ] Темы/декор

### Неделя 7-8: Финализация
- [ ] Генератор тестов
- [ ] Облачный sync (E2EE)
- [ ] S3 бэкап
- [ ] Релиз Beta

## Качество и производительность

### Производительность
- **120Hz рендер**: кистей и анимаций
- **Батчирование штрихов**: оптимизация отрисовки
- **Тайловый рендер PDF**: для больших документов
- **Lazy-loading**: страниц и компонентов
- **Фоновые воркеры**: для OCR и AI

### Тестирование
- **Unit тесты**: для ink-engine
- **Интеграционные**: для CRDT/синхронизации
- **Нагрузочные**: для больших PDF
- **E2E тесты**: Playwright

## Лицензия

Apache 2.0 - открытая лицензия для свободного использования и модификации.

## Контрибьюторы

Проект открыт для контрибьюторов. См. CONTRIBUTING.md для деталей.

---

*Последнее обновление: 16.09.2025*
